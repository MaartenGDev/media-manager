!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.mediaManager=t():e.mediaManager=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),c=function(e){return e&&e.__esModule?e:{default:e}}(i);r(2);var u=r(3),l=function(){function e(){s(this,e)}return o(e,[{key:"_buildWrapper",value:function(){var e=this.settings,t=document.createElement("section");return t.classList.add(e.classes.wrapper),t}},{key:"_buildHeader",value:function(){var e=this.settings,t=document.createElement("section");t.classList.add(e.classes.header);var r=document.createElement("p");r.classList.add(e.classes.headerTitle);var n=document.createTextNode(e.labels.title);return r.appendChild(n),t.appendChild(r),t}},{key:"_buildActionBar",value:function(){var e=this.settings,t=document.createElement("input");t.setAttribute("type","file"),t=(0,u.addClassesToNode)(t,e.classes.uploadButton),t.appendChild(document.createTextNode("Upload"));var r=document.createElement("section");return r=(0,u.addClassesToNode)(r,e.classes.actionBar),r.appendChild(t),r}},{key:"_buildResourcePreviews",value:function(){var e=this.settings,t=document.createElement("section");return t.classList.add(e.classes.contentWrapper),e.source.resources.map(function(t){var r=t.path,n=document.createElement("section");n.classList.add(e.classes.item),n.dataset.src=r,n.style.position="relative",n.style.backgroundImage="url('"+r+"')",n.style.backgroundSize="cover",n.style.backgroundRepeat="no-repeat";var s=document.createElement("i");return s=(0,u.addClassesToNode)(s,e.classes.deleteItemIcon),s.appendChild(document.createTextNode("delete")),s.dataset.src=t.path,n.appendChild(s),n}).forEach(function(e){return t.appendChild(e)}),t}},{key:"_buildFooter",value:function(){var e=this.settings,t=document.createElement("section");t.classList.add(e.classes.footer);var r=document.createElement("button");r.setAttribute("type","button"),r=(0,u.addClassesToNode)(r,e.classes.confirmButton),r.appendChild(document.createTextNode("Confirm"));var n=document.createElement("button");return n.setAttribute("type","button"),n=(0,u.addClassesToNode)(n,e.classes.cancelButton),n.appendChild(document.createTextNode("Cancel")),t.appendChild(r),t.appendChild(n),t}},{key:"_buildOverlay",value:function(){var e=document.createElement("section");return e=(0,u.addClassesToNode)(e,this.settings.classes.overlay)}},{key:"_appendOverlayIfNotPresent",value:function(){if(null===document.querySelector((0,u.createSelector)(this.settings.classes.overlay))){var e=this._buildOverlay();document.querySelector("body").appendChild(e)}}},{key:"_toggleOverlay",value:function(e){this._appendOverlayIfNotPresent(),document.querySelector((0,u.createSelector)(this.settings.classes.overlay)).classList.toggle(this.settings.classes.activeOverlay,e)}},{key:"_toggleMediaManager",value:function(){var e=this.settings,t=e.state.isShown;e.settings.showOverlay&&this._toggleOverlay(!t),this._clearSelectedItems();var r=e.elements.wrapper.querySelector((0,u.createSelector)(e.classes.wrapper));console.log(r),null!==r?r.style.display=t?"none":"block":this._appendMediaManagerToWrapper(),this.settings.state.selectedResources=[],this.settings.state.isShown=!t}},{key:"_clearSelectedItems",value:function(){var e=this.settings.classes,t=(0,u.createSelector)([e.item,e.activeItem]);document.querySelectorAll(t).forEach(function(t){t.classList.remove(e.activeItem)})}},{key:"_appendMediaManagerToWrapper",value:function(){var e=this._buildWrapper();e.appendChild(this._buildHeader()),e.appendChild(this._buildActionBar()),e.appendChild(this._buildResourcePreviews()),e.appendChild(this._buildFooter()),this.settings.elements.wrapper.appendChild(e),this._registerEventListenersForMediaActions(),this._registerEventListenersForActionBar()}},{key:"_registerEventListenersForActionBar",value:function(){var e=this.settings,t=(0,u.createSelector)(e.classes.uploadButton);document.querySelector(t).addEventListener("change",e.events.onFileSelectionChanged)}},{key:"_registerEventListenersForMediaActions",value:function(){var e=this,t=this.settings;t.elements.wrapper.addEventListener("click",function(r){var s=r.target;if(s.classList.contains(t.classes.item)){var a=e.settings.state.selectedResources,o=a.length===t.settings.maxSelectedItems,i=s.dataset.src;a.filter(function(e){return e.path===i}).length>0?(e.settings.state.selectedResources=a.filter(function(e){return e.path!==i}),s.classList.toggle(t.classes.activeItem,!1)):o||(e.settings.state.selectedResources=[].concat(n(a),[t.source.resources.find(function(e){return e.path===i})]),s.classList.toggle(t.classes.activeItem,!0))}});var r=(0,u.createSelector)(t.classes.confirmButton),s=(0,u.createSelector)(t.classes.cancelButton);document.querySelector(r).addEventListener("click",function(){t.events.onConfirm(e.settings.state.selectedResources),e._toggleMediaManager()}),document.querySelector(s).addEventListener("click",function(r){r.preventDefault(),t.events.onCancel(),e._toggleMediaManager()}),this._registerDeleteItemEventListeners()}},{key:"_registerDeleteItemEventListeners",value:function(){var e=this,t=this.settings,r=t.events,s=t.classes,a=t.source,o=(0,u.createSelector)(s.deleteItemIcon);[].concat(n(document.querySelectorAll(o))).forEach(function(t){t.addEventListener("click",function(t){t.preventDefault();var n=a.resources.find(function(e){return e.path===t.target.dataset.src});return Promise.resolve(r.onDeleteItem(n)).then(function(t){t&&e._remove(n)})})})}},{key:"_isValidResource",value:function(e){return"object"===(void 0===e?"undefined":a(e))&&e.hasOwnProperty("path")}},{key:"_remove",value:function(e){this.settings.source.resources=[].concat(n(this.settings.source.resources)).filter(function(t){return t.path!==e.path}),this.settings.state.selectedResources=[],this._refreshResourcePreviews()}},{key:"_refreshResourcePreviews",value:function(){var e=this.settings.classes,t=e.wrapper,r=e.contentWrapper,n=(0,u.createSelector)(t),s=(0,u.createSelector)(r);this.settings.state.isShown&&(document.querySelector(n+" "+s).outerHTML=this._buildResourcePreviews().outerHTML),this._registerDeleteItemEventListeners()}},{key:"on",value:function(e,t){this.settings.events[e]=t}},{key:"toggle",value:function(){this._toggleMediaManager()}},{key:"add",value:function(e){if(!this._isValidResource(e))return console.error("The resource has to be an object with a path key.");this.settings.source.resources=[].concat(n(this.settings.source.resources),[e]),this._refreshResourcePreviews()}},{key:"init",value:function(e){e=(0,c.default)({elements:{wrapper:""},state:{isShown:!1,selectedResources:[]},settings:{showOverlay:!0,maxSelectedItems:-1},classes:{wrapper:"media-manager",overlay:"media-manager__overlay",activeOverlay:"media-manager__overlay--active",header:"media-manager__header",headerTitle:"media-manager__title",contentWrapper:"media-manager__content",item:"media-manager__item",activeItem:"media-manager__item--active",deleteItemIcon:["material-icons","media-manager__trash-icon"],footer:"media-manager__footer",actionBar:"media-manager__action-bar",confirmButton:["media-manager__button","media-manager__button--confirm"],cancelButton:["media-manager__button","media-manager__button--cancel"],uploadButton:["media-manager__button","media-manager__button--upload"]},labels:{title:"Media Manager"},events:{onCancel:function(){},onConfirm:function(){},onDeleteItem:function(){},onFileSelectionChanged:function(){}},source:{resources:[]}},e),this.settings=e}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return!!e&&"object"==typeof e}function s(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||a(e)}function a(e){return e.$$typeof===p}function o(e){return Array.isArray(e)?[]:{}}function i(e,t){return t&&!0===t.clone&&d(e)?l(o(e),e,t):e}function c(e,t,r){var n=e.slice();return t.forEach(function(t,s){void 0===n[s]?n[s]=i(t,r):d(t)?n[s]=l(e[s],t,r):-1===e.indexOf(t)&&n.push(i(t,r))}),n}function u(e,t,r){var n={};return d(e)&&Object.keys(e).forEach(function(t){n[t]=i(e[t],r)}),Object.keys(t).forEach(function(s){d(t[s])&&e[s]?n[s]=l(e[s],t[s],r):n[s]=i(t[s],r)}),n}function l(e,t,r){var n=Array.isArray(t),s=Array.isArray(e),a=r||{arrayMerge:c};if(n===s)return n?(a.arrayMerge||c)(e,t,r):u(e,t,r);return i(t,r)}var d=function(e){return n(e)&&!s(e)},f="function"==typeof Symbol&&Symbol.for,p=f?Symbol.for("react.element"):60103;l.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return l(e,r,t)})};var m=l;e.exports=m},function(e,t){},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createSelector=t.createClassSelector=t.mergeSelectors=t.addClassesToNode=void 0;var s=r(4),a=r(5),o=[".","#"],i=t.addClassesToNode=function(e,t){var r;return t=(0,s.toArray)(t),(r=e.classList).add.apply(r,n(t)),e},c=function(e){return o.filter(function(t){return e.startsWith(t)}).length>0},u=t.mergeSelectors=function(e){return e.join("")},l=t.createClassSelector=function(e){return(0,a.isString)(e)?c(e)?e:"."+e:e.map(function(e){return c(e)?e:"."+e})};t.createSelector=function(e){return u(l((0,s.toArray)(e)))};t.default={addClassesToNode:i,mergeSelectors:u,createClassSelector:l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.toArray=function(e){return"string"==typeof e?[e]:e};t.default={toArray:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.isString=function(e){return"string"==typeof e};t.default={isString:n}}])});